# basics
import anndata as ad

adata.X
adata.obs
adata.var

# convert to dataframe
adata.to_df(layer="")

# subset using cell/gene ids
adata[["cell1", "cell2"], ["gene1", "gene2"]]

# subset based on metadata
adata[adata.obs.donor_id == "A"]

# read 
ad.read_h5ad("dat.h5ad")

# write compressed h5ad file
import hdf5plugin
adata.write("dat.h5ad", compression=hdf5plugin.FILTERS["zstd"])

# vi:syntax=python
